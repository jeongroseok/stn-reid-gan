# 요약


# 1. 서론
사람 재인식은 이미지 검색 문제의 일부이며, 다중 카메라 환경에서 특정 인물을 검색하는 것을 목표한다. 주로 실종자나 범죄자를 찾아내는 감시 카메라 시스템등에 사용되는 중요한 기술이다.
이미지 검색은 질의된 이미지로부터 구분가능한 주요 특성 벡터를 추출하여 거리를 기준으로 검색한다.
하지만 사람 재인식이 행해지는 환경은 촬영 위치 변화, 조도 변화, 자세 변화, 가려짐(occlusions; $단어교체), 배경 노이즈(background clutter; $단어교체?), 불안정한 경계 상자 생성등으로 인해 같은 사람일지라도  다양한 변형이 존재한다. 따라서 변형에 강인한 주요 특성 벡터를 추출하는 것이 사람 재인식의 중요한 문제이다.
최근 CNN 구조가 사람 재인식 분야에 적용되었지만, 자유자제로 변화하는 사람의 외형은 intra-class variations($번역)을 가지고 있으므로 주요 특성만 집중적으로 뽑아내는 일은 여전히 어려운 문제이다. 이에따라, intra-class variations($번역)에 강인한 특성을 추출하고자 분리된 표현 학습을 사용하는 방법이 시도 되고 있다.

분리된 표현 학습(Disentangled Representation Learning)은 원하는 특성을 선택적으로 추출할 수 있다. 라벨을 만들기 어렵거나 불가능한 이미지-이미지 번역(Image-to-Image Translation), 비지도 도메인 적용(Unsupervised Domain Adaptation)등의 사용된다.
그림의 화풍을 변경하거나, 자연환경이 촬영된 사진의 계절을 변경하는 등의 이미지-이미지 번역 작업을 수행 하기 위해서 컨텐츠 특성은 보존한 채 스타일 특성만 변형할 수 있어야 한다.
MUNIT에서는 특정 도메인에서 컨텐츠 특성과 스타일 특성을 분리하여 추출하는 두개의 인코더와 하나의 디코더, 그리고 디코더로부터 생성된 이미지가 실제 이미지 분포와 같은지 판단하는 판별기를 통해 이미지의 분리된 두가지 특성을 자유롭게 변형할 수 있다.
사람 재인식에서 MUNIT구조를 사용한 DG-NET에서는 사람의 외형 특성과 구조 특성을 분리하였고, intra-class variations에 강인한 외형 특성만을 식별에 사용하여 정확도를 높였다.

하지만 분리된 표현을 학습하더라도 CNN을 사용하는 모델은 크기와 회전 변화에 취약하며 이러한 문제는 공간 변환 네트워크(Spatial Transformer Network)를 추가함으로써 완화할 수 있다. 공간 변환 네트워크는 입력된 이미지를 인식하기 쉽도록 변형하는 변환 행렬을 생성하여 적용한다. 본 논문에서는 크기와 회전 변화에 강인한 분리된 특성을 추출하고자 공간 변환 네트워크를 추가하여 성능을 개선하였다.


# 2. 방법
본 논문이 제안하는 모델은 MUNIT의 외형과 구조 특성을 추출하는 인코더와 디코더 그리고 Pix2Pix의 PatchGAN 판별기를 사용하였다. 인코더가 분리된 표현을 학습하기 위해서 DG-NET에서 제안하는 자기 신원 생성(Self-identity generation)과 교차 신원 생성(Cross-identity generation)을 사용 하였으며, 인코더의 앞에 공간 변환 네트워크를 추가 하였다.
## 2.1. 자기 신원 생성(Self-identity generation)
자기 신원 생성 과정은 같은 사람이 촬영된 두장의 다른 이미지 x_i, x_j 에서 외형 특성 a_i, a_j 그리고 구조 특성 s_i, s_j를 추출한다. 이때, a_i와 a_j는 같은 사람의 외형 특성이므로 같은 정보를 나타내며 s_i와 s_j는 각 이미지의 자세, 배경, 조도등의 기타 구조 정보를 나타낸다. 따라서, 두가지 특성 쌍의 조합과 디코더 G를 통해 생성된 이미지는 s특성을 추출한 쪽의 이미지와 동일해야한다. 이러한 구조에서 인코더와 디코더는 L1 손실 함수를 사용하는 식(1)을 통해 학습한다. 
추가로 a_i, a_j 특성의 거리가 좁혀질 수 있도록 identification loss 함수를 적용한다.
## 2.2. 교차 신원 생성(Self-identity generation)
교차 신원 생성 과정은 다른 사람의 이미지 두장으로부터 외형 특성과 구조 특성을 추출한다. 추출된 특성 쌍의 조합으로 생성된 이미지에서 두 특성을 다시 추출하여 생성에 사용된 생성에 사용된 특성과 다시 추출된 특성이 같아질 수 있도록 식(2)를 적용한다.
자기 신원 생성 과정과 마찬가지로 Identification loss함수 또한 적용한다. 추가로 교차 생성 과정에서 만들어진 이미지가 실제 이미지 분포와 유사해질 수 있도록 식(3)을 적용한다.
## 2.3. 공간 변형 네트워크
공간 변형에 3 x 2 행렬을 사용하는 아핀 변환(Affine transform)을 사용 하였다. 아핀 변환에 사용될 행렬을 생성하기 위해 두개의 컨볼루션 레이어를 가지는 네트워크를 추가 하였다.

# 3. 결과 및 분석


논문
